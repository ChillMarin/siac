moment.locale("es"),Vue.use(VueTelInputVuetify,{vuetify:vuetify});let vm=new Vue({vuetify:vuetify,el:"#siac-suite-container",data:{select:!1,barAlert:!1,barMessage:"",barTimeout:3e3,patient_select:!1,loading:!1,loading_form:!1,patient_create_loading:!1,dialog:!1,create_dialog:!1,patient_dialog:!1,appointment_date_modal:!1,appointment_time_modal:!1,entry_date_modal:!1,birthdate_modal:!1,appointment_date_dialog:"",appointment_time_dialog:"",entry_date_dialog:"",search:"",appointments:[],patient_appointments:[],headers:[{text:"Fecha de la cita",align:"start",value:"appointment_date"},{text:"Hora de la cita",value:"appointment_time"},{text:"Doctor",value:"full_name"},{text:"Tipo de cita",value:"appointment_type"},{text:"Motivo de la cita",value:"appointment_reason"}],genders:[{name:"Masculino",gender:"M"},{name:"Femenino",gender:"F"}],document_types:[{text:"DNI",value:"DNI"},{text:"Pasaporte",value:"pasaporte"}],doctors:[],patients:[],patients_list:[],appointment_types:[{text:"Primera vez"},{text:"Consulta de chequeo"}],patient:{first_name:"",last_name:"",document_type:"",document_id:"",birthdate:"",gender:"",address:"",email:"",telephone:"",whatsapp:"0",telegram:"0",sms:"0",entry_date:"",meta:{}},patient_default:{first_name:"",last_name:"",document_type:"",document_id:"",birthdate:"",gender:"",address:"",email:"",telephone:"",whatsapp:"0",telegram:"0",sms:"0",entry_date:"",meta:{}},form:{appointment_id:"",patient_id:"",doctor:"",appointment_reason:"",appointment_type:"",appointment_date:"",appointment_time:""},form_default:{appointment_id:"",patient_id:"",doctor:"",appointment_reason:"",appointment_type:"",appointment_date:"",appointment_time:""},appointment_selected:{}},computed:{FormTitle(){return""!=this.form.appointment_id?"Editar cita":"AÃ±adir cita"}},created(){this.getDoctors(),this.getPatients(),this.initialize()},mounted(){},methods:{initialize(){var t=this,e=api_url+"appointments/get-upcm-appointments/";t.$http.get(e).then(e=>{if(e.body.length>0){var a=[];e.body.forEach((t,e)=>{var i={appointment_id:t.appointment_id,start:moment(t.appointment_date+" "+t.appointment_time).toISOString(),appointment_date:t.appointment_date,appointment_time:t.appointment_time,appointment_reason:t.appointment_reason,appointment_type:t.appointment_type,title:t.patient,doctor:t.doctor,patient_id:t.patient_id,user_id:t.user_id};a.push(i)}),t.appointments=a}t.renderCalendar()},t=>{})},renderCalendar(){var t=this;document.getElementById("siac-suite-container").style.display="inline";var e=document.getElementById("calendar"),a=new FullCalendar.Calendar(e,{eventClick:e=>{var a=e.event.extendedProps,i={patient:e.event.title,appointment_date:e.event.startStr,props:a};t.appointmentDetails(i)},dateClick:e=>{t.form.appointment_date=e.dateStr,t.create_dialog=!0},themeSystem:"Materia",initialView:"dayGridMonth",dayMaxEventRows:!0,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,dayGridDay"},locale:"es",events:t.appointments});a.render()},appointmentDetails(t){var e=this;e.appointment_selected=t;var a=api_url+"appointments/get/"+e.appointment_selected.props.patient_id;e.dialog=!0,e.$http.get(a).then(t=>{e.patient_appointments=t.body},t=>{})},getDoctors(){var t=this,e=api_url+"members/get-doctors";0==t.doctors.length&&(t.select=!0,t.$http.get(e).then(e=>{t.select=!1,t.doctors=e.body},e=>{t.select=!1}))},getPatients(){var t=this,e=api_url+"patients/get-list";t.patient_select=!0,t.$http.get(e).then(e=>{t.patient_select=!1,t.patients=e.body,t.patients_list=e.body},e=>{t.patient_select=!1})},getTelephoneInput(t,e){this.patient.telephone=e.number.international},searchPatients(t){var e=this;e.search||(e.patients=e.patients_list),e.patients=e.patients_list.filter(t=>t.full_name.toLowerCase().indexOf(e.search.toLowerCase())>-1)},saveAppointment(){var t=this,e=t.form;t.loading_form=!0;var a=api_url+"appointments/create";""!=e.appointment_id?(a=api_url+"appointments/update",t.$http.post(a,e).then(a=>{t.loading_form=!1,"success"==a.body.status&&(t.edit_dialog=!1,t.barAlert=!0,t.barMessage=a.body.message,t.appointment_selected.props=Object.assign({},e),e=Object.assign({},t.form_default),t.closeEditDialog(),t.initialize())},e=>{t.loading_form=!1})):t.$http.post(a,e).then(a=>{t.loading_form=!1,"success"==a.body.status&&(t.create_dialog=!1,t.barAlert=!0,t.barMessage=a.body.message,t.initialize(),e=Object.assign(t.form_default))},e=>{t.loading_form=!1})},savePatient(){var t=this,e=api_url+"patients/create";t.patient_create_loading=!0,t.$http.post(e,t.patient).then(e=>{if(t.patient_create_loading=!1,"success"==e.body.status){t.patient.patient_id=e.body.data.patient_id;var a={full_name:t.patient.first_name+" "+t.patient.last_name,patient_id:t.patient.patient_id};t.patients.push(a),t.patients_list.push(a),t.search="",t.searchPatients(),t.form.patient_id=a.patient_id,t.patient_dialog=!1}},e=>{t.patient_create_loading=!1})},editDialog(){var t=this;t.form=Object.assign({},t.appointment_selected.props),t.create_dialog=!0},closeEditDialog(){var t=this;t.form=Object.assign({},t.form_default),t.create_dialog=!1},fromNow:t=>moment(t).format("LL")}});