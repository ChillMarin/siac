moment.locale("es");let vm=new Vue({vuetify:vuetify,el:"#siac-suite-container",data:{select:!1,patient_select:!1,loading:!1,loading_form:!1,patient_create_loading:!1,dialog:!1,create_dialog:!1,patient_dialog:!1,appointment_date_modal:!1,appointment_time_modal:!1,entry_date_modal:!1,birthdate_modal:!1,appointment_date_dialog:"",appointment_time_dialog:"",entry_date_dialog:"",search:"",appointments:[],patient_appointments:[],headers:[{text:"Fecha de la cita",align:"start",value:"appointment_date"},{text:"Hora de la cita",value:"appointment_time"},{text:"Doctor",value:"full_name"},{text:"Tipo de cita",value:"appointment_type"},{text:"Motivo de la cita",value:"appointment_reason"}],genders:[{name:"Masculino",gender:"M"},{name:"Femenino",gender:"F"}],document_types:[{text:"DNI",value:"DNI"},{text:"Pasaporte",value:"pasaporte"}],doctors:[],patients:[],patients_list:[],appointment_types:[{text:"Primera vez"},{text:"Consulta de chequeo"}],patient:{first_name:"",last_name:"",document_type:"",document_id:"",birthdate:"",gender:"",address:"",email:"",telephone:"",whatsapp:"0",telegram:"0",sms:"0",entry_date:""},patient_default:{first_name:"",last_name:"",document_type:"",document_id:"",birthdate:"",gender:"",address:"",email:"",telephone:"",whatsapp:"0",telegram:"0",sms:"0",entry_date:""},form:{patient_id:"",doctor:"",appointment_reason:"",appointment_type:"",appointment_date:"",appointment_time:""},appointment_selected:{}},computed:{},created:function(){this.getDoctors(),this.getPatients(),this.initialize()},mounted:function(){},methods:{initialize:function(){var e=this,t=api_url+"appointments/get-upcm-appointments/";e.$http.get(t).then(t=>{var a;0<t.body.length&&(a=[],t.body.forEach((t,e)=>{t={appointment_id:t.appointment_id,start:moment(t.appointment_date+" "+t.appointment_time).toISOString(),appointment_date:t.appointment_date,appointment_time:t.appointment_time,appointment_reason:t.appointment_reason,appointment_type:t.appointment_type,title:t.patient,doctor:t.doctor,patient_id:t.patient_id,user_id:t.user_id};a.push(t)}),e.appointments=a,e.renderCalendar())},t=>{})},renderCalendar:function(){var a=this;document.getElementById("siac-suite-container").style.display="inline";var t=document.getElementById("calendar");new FullCalendar.Calendar(t,{eventClick:t=>{var e=t.event.extendedProps,e={patient:t.event.title,appointment_date:t.event.startStr,props:e};a.appointmentDetails(e)},themeSystem:"Materia",initialView:"dayGridMonth",dayMaxEventRows:!0,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,dayGridDay"},locale:"es",events:a.appointments}).render()},appointmentDetails:function(t){var e=this;e.appointment_selected=t;t=api_url+"appointments/get/"+e.appointment_selected.props.patient_id;e.dialog=!0,e.$http.get(t).then(t=>{e.patient_appointments=t.body},t=>{})},getDoctors:function(){var e=this,t=api_url+"members/get-doctors";0==e.doctors.length&&(e.select=!0,e.$http.get(t).then(t=>{e.select=!1,e.doctors=t.body},t=>{e.select=!1}))},getPatients:function(){var e=this,t=api_url+"patients/get-list";e.patient_select=!0,e.$http.get(t).then(t=>{e.patient_select=!1,e.patients=t.body,e.patients_list=t.body},t=>{e.patient_select=!1})},searchPatients:function(t){var e=this;e.search||(e.patients=e.patients_list),e.patients=e.patients_list.filter(t=>-1<t.full_name.toLowerCase().indexOf(e.search.toLowerCase()))},saveAppointment:function(){var e=this,t=e.form;e.loading_form=!0;var a=api_url+"appointments/create";e.$http.post(a,t).then(t=>{if(e.loading_form=!1,"success"==t.body.status)return e.create_dialog=!1,e.initialize(),!0},t=>{e.loading_form=!1})},savePatient:function(){var e=this,t=api_url+"patients/create";e.patient_create_loading=!0,e.$http.post(t,e.patient).then(t=>{e.patient_create_loading=!1,"success"==t.body.status&&(e.patient.patient_id=t.body.data.patient_id,t={full_name:e.patient.first_name+" "+e.patient.last_name,patient_id:e.patient.patient_id},e.patients.push(t),e.patients_list.push(t),e.search="",e.searchPatients(),e.form.patient_id=t.patient_id,e.patient_dialog=!1)},t=>{e.patient_create_loading=!1})},fromNow:function(t){return moment(t).format("LL")}}});