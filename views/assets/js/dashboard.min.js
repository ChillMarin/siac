moment.locale("es"),Vue.use(VueTelInputVuetify,{vuetify:vuetify});let vm=new Vue({vuetify:vuetify,el:"#siac-suite-container",data:{barAlert:!1,barTimeout:1e3,barMessage:"",barType:"",select:!1,patient_select:!1,loading:!1,loading_form:!1,patient_create_loading:!1,dialog:!1,create_dialog:!1,patient_dialog:!1,appointment_date_modal:!1,appointment_time_modal:!1,entry_date_modal:!1,birthdate_modal:!1,appointment_date_dialog:"",appointment_time_dialog:"",entry_date_dialog:"",search:"",appointments:[],patient_appointments:[],headers:[{text:"Fecha de la cita",align:"start",value:"appointment_date"},{text:"Hora de la cita",value:"appointment_time"},{text:"Doctor",value:"full_name"},{text:"Tipo de cita",value:"appointment_type"},{text:"Motivo de la cita",value:"appointment_reason"}],genders:[{name:"Masculino",gender:"M"},{name:"Femenino",gender:"F"}],document_types:[{text:"DNI",value:"DNI"},{text:"Pasaporte",value:"pasaporte"}],doctors:[],patients:[],patients_list:[],appointment_types:[{text:"Primera vez"},{text:"Consulta de chequeo"}],patient:{first_name:"",last_name:"",document_type:"",document_id:"",birthdate:"",gender:"",address:"",email:"",telephone:"",whatsapp:"0",telegram:"0",sms:"0",entry_date:""},patient_default:{first_name:"",last_name:"",document_type:"",document_id:"",birthdate:"",gender:"",address:"",email:"",telephone:"",whatsapp:"0",telegram:"0",sms:"0",entry_date:""},form:{patient_id:"",doctor:"",appointment_reason:"",appointment_type:"",appointment_date:"",appointment_time:""},appointment_selected:{}},computed:{},created(){this.getDoctors(),this.getPatients(),this.initialize()},mounted(){},methods:{initialize(){var t=this,e=api_url+"appointments/get-upcm-appointments/";t.$http.get(e).then(e=>{if(e.body.length>0){var a=[];e.body.forEach((t,e)=>{var n={appointment_id:t.appointment_id,start:moment(t.appointment_date+" "+t.appointment_time).toISOString(),appointment_date:t.appointment_date,appointment_time:t.appointment_time,appointment_reason:t.appointment_reason,appointment_type:t.appointment_type,title:t.patient,doctor:t.doctor,patient_id:t.patient_id,user_id:t.user_id};a.push(n)}),t.appointments=a}t.renderCalendar()},t=>{})},renderCalendar(){var t=this;document.getElementById("siac-suite-container").style.display="inline";var e=document.getElementById("calendar"),a=new FullCalendar.Calendar(e,{eventClick:e=>{var a=e.event.extendedProps,n={patient:e.event.title,appointment_date:e.event.startStr,props:a};t.appointmentDetails(n)},dateClick:e=>{t.form.appointment_date=e.dateStr,t.create_dialog=!0},themeSystem:"Materia",initialView:"dayGridMonth",dayMaxEventRows:!0,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,dayGridDay"},locale:"es",events:t.appointments});a.render()},appointmentDetails(t){var e=this;e.appointment_selected=t;var a=api_url+"appointments/get/"+e.appointment_selected.props.patient_id;e.dialog=!0,e.$http.get(a).then(t=>{e.patient_appointments=t.body},t=>{})},getDoctors(){var t=this,e=api_url+"members/get-doctors";0==t.doctors.length&&(t.select=!0,t.$http.get(e).then(e=>{t.select=!1,t.doctors=e.body},e=>{t.select=!1}))},getPatients(){var t=this,e=api_url+"patients/get-list";t.patient_select=!0,t.$http.get(e).then(e=>{t.patient_select=!1,t.patients=e.body,t.patients_list=e.body},e=>{t.patient_select=!1})},searchPatients(t){var e=this;e.search||(e.patients=e.patients_list),e.patients=e.patients_list.filter(t=>t.full_name.toLowerCase().indexOf(e.search.toLowerCase())>-1)},saveAppointment(){var t=this,e=t.form;t.loading_form=!0;var a=api_url+"appointments/create";t.$http.post(a,e).then(e=>{t.loading_form=!1,"success"==e.body.status&&(t.create_dialog=!1),t.initialize(),activateAlert(e.body.message,e.body.status)},e=>{t.loading_form=!1})},savePatient(){var t=this,e=api_url+"patients/create";t.patient_create_loading=!0,t.$http.post(e,t.patient).then(e=>{if(t.patient_create_loading=!1,"success"==e.body.status){t.patient.patient_id=e.body.data.patient_id;var a={full_name:t.patient.first_name+" "+t.patient.last_name,patient_id:t.patient.patient_id};t.patients.push(a),t.patients_list.push(a),t.search="",t.searchPatients(),t.form.patient_id=a.patient_id,t.patient_dialog=!1}activateAlert(e.body.message,e.body.status)},e=>{t.patient_create_loading=!1})},getTelephoneInput(t,e){this.patient.telephone=e.number.international},fromNow:t=>moment(t).format("LL")}});