Vue.use(VueTelInputVuetify,{vuetify:vuetify});let vm=new Vue({vuetify:vuetify,el:"#siac-suite-container",data:{barAlert:!1,barTimeout:1e3,barMessage:"",barType:"",dialog:!1,dialogAccess:!1,viewInvitationsDialog:!1,image_loading:!1,upload_button:!1,dialogDelete:!1,dialogAccess:!1,menu:"",previewImage:"",headers:[{text:"Nombre Completo",align:"start",value:"full_name"},{text:"Rol",value:"rol"},{text:"Correo electrónico",value:"email"},{text:"Teléfono",value:"telephone"},{text:"Acciones",value:"actions",align:"center",sortable:!1}],members:[],upcm_invitations:{dialog:!1,loading:!1,create_loading:!1,items:[],headers:[{text:"Nombre completo",align:"start",value:"full_name"},{text:"Correo electrónico",value:"user_email"},{text:"Rol",value:"rol"},{text:"Acciones",value:"actions",align:"center",sortable:!1}],editedItem:{first_name:"",last_name:"",user_email:"",user_type:"miembro",rol:"Cardiólogo",created_at:"",already_used:0},defaultItem:{first_name:"",last_name:"",user_email:"",user_type:"miembro",rol:"Cardiólogo",created_at:"",already_used:0}},rols:["Cardiólogo","Enfermera","Enfermero","Secretaria"],genders:[{name:"Masculino",gender:"M"},{name:"Femenino",gender:"F"}],access:{loading:!1,defaultItem:{patient_management_access:{access:1,sections:[{name:"Pacientes",page:"patients",permissions:{create:0,read:0,update:0,delete:0}},{name:"Citas",page:"appointments",permissions:{create:0,read:0,update:0,delete:0}}]},calculations_and_algorithms_access:{access:1},patient_material_access:{access:1,sections:[{name:"Materiales para pacientes",page:"patients",permissions:{create:0,read:0,delete:0}},{name:"Plantillas",page:"templates",permissions:{create:0,read:0,delete:0}}]},notifications_access:{access:1,publish:1}}},editedIndex:-1,user:{},editedItem:{full_name:"",rol:"",email:"",telephone:"",meta:{}},defaultItem:{full_name:"",rol:"",email:"",telephone:"",whatsapp:"0",telegram:"0",sms:"0",meta:{}}},computed:{formTitle:()=>"Editar Miembro"},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()},upcmInvitationsDialog(e){e||this.closeInvitation()}},created(){this.initialize(),this.initializeInvitations()},mounted(){},methods:{initialize(){var e=api_url+"members/upcm-members";this.$http.get(e).then(e=>{e.body.forEach(e=>{Array.isArray(e.meta)&&(e.meta={})}),this.members=e.body},e=>{})},initializeInvitations(){var e=api_url+"upcm-invitations/get";this.$http.get(e).then(e=>{this.upcm_invitations.items=e.body},e=>{})},editItem(e){this.editedIndex=this.members.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},editAccessItem(e){this.editedIndex=this.members.indexOf(e),this.editedItem=Object.assign({},e),this.editedItem.meta=0===Object.keys(e.meta).length?Object.assign({},this.access.defaultItem):Object.assign({},e.meta),this.dialogAccess=!0},editInvitationItem(){this.upcm_invitations.editedItem=Object.assign({},this.upcm_invitations.defaultItem),this.upcmInvitationsDialog=!0},deleteItem(e){this.editedIndex=this.members.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm(){var e=this.editedItem.user_id,t=api_url+"members/delete";this.$http.post(t,{user_id:e}).then(e=>{this.members.splice(this.editedIndex,1),this.closeDelete(),activateAlert(e.body.message,e.body.status)},e=>{this.closeDelete()})},close(){this.dialog=!1,this.previewImage="",this.upload_button=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeAccess(){this.dialogAccess=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeInvitation(){this.upcmInvitationsDialog=!1,this.$nextTick(()=>{this.upcm_invitations.editedItem=Object.assign({},this.upcm_invitations.defaultItem),this.upcm_invitations.editedIndex=-1})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},prevImage(e){const t=e.target.files[0],i=new FileReader;i.readAsDataURL(t),i.onload=(e=>{this.editedItem.avatar=t,this.previewImage=e.target.result,this.upload_button=!0})},uploadImage(e){var t=this;let i=new FormData;var a=api_url+"members/update-member-avatar";t.image_loading=!0,i.append("avatar",t.editedItem.avatar),i.append("user_id",t.editedItem.user_id),t.$http.post(a,i).then(e=>{t.image_loading=!1,activateAlert(e.body.message,e.body.status)},e=>{})},save(){var e=this,t=e.editedItem,i=e.editedIndex,a=api_url+"members/update";e.$http.post(a,t).then(a=>{"success"==a.body.status&&Object.assign(e.members[i],t),e.close(),activateAlert(a.body.message,a.body.status)},t=>{e.close()})},saveAccess(){var e=this,t=e.editedItem,i=e.editedIndex,a=api_url+"user-access/update";e.access.loading=!0,e.$http.post(a,t).then(a=>{e.access.loading=!1,"success"==a.body.status&&Object.assign(e.members[i],t),e.closeAccess(),activateAlert(a.body.message,a.body.status)},t=>{e.closeAccess()})},saveInvitation(){var e=this,t=e.upcm_invitations.editedItem;t.upcm_id=e.editedItem.upcm_id,t.upcm_name=e.editedItem.upcm_name,e.upcm_invitations.create_loading=!0;var i=api_url+"upcm-invitations/create";e.$http.post(i,t).then(i=>{"success"==i.body.status&&(t.created_at=current_date,t.upcm_invitation_id=i.body.data.upcm_invitation_id,t.invitation_code=i.body.data.invitation_code,e.upcm_invitations.items.push(t)),e.upcm_invitations.create_loading=!1,activateAlert(i.body.message,i.body.status),e.closeInvitation()},t=>{e.upcm_invitations.create_loading=!1,e.closeInvitation()})},editInvitationItem(){this.upcm_invitations.editedItem=Object.assign({},this.upcm_invitations.defaultItem),this.upcmInvitationsDialog=!0},deleteInvitation(e){var t=this,i=t.upcm_invitations.items.indexOf(e),a=api_url+"upcm-invitations/delete/"+e.upcm_invitation_id;t.$http.get(a).then(e=>{"success"==e.body.status&&t.upcm_invitations.items.splice(i,1)},e=>{})},getTelephoneInput(e,t){this.editedItem.telephone=t.number.international},filterAccessByRol(){if("miembro"==app.editedItem){var e=[{rol_obj:"cardiologist",rol:"Cardiólogo"},{rol_obj:"nurse",rol:"Enfermera"},{rol_obj:"nurse",rol:"Enfermero"},{rol_obj:"secretary",rol:"Secretaria"}],t=e.find(e=>e.rol==app.editedItem.rol);t.hasOwnProperty("rol_obj")&&(app.editedItem.meta=Object.assign({},user_roles[t.rol_obj]))}},copyToClipboard(e){navigator.clipboard.writeText(e)}}});