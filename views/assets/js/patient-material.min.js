let vm=new Vue({vuetify:vuetify,el:"#siac-suite-container",data:{barAlert:!1,barTimeout:1e3,barMessage:"",barType:"",loading:!1,material_loading:!1,dialog:!1,dialogDelete:!1,materialFormDialog:!1,viewDialog:!1,search:"",searched:!1,title:"",material_type:"",editor1Content:"",editor2Content:"",options:{year:"numeric",month:"long",day:"numeric"},isSelected:!1,patient_id:"",patient_fullname:"",patient_results:[],patients:[],headers:[{text:"Fecha del material enviado",align:"start",value:"registered_at",width:"auto"},{text:"Nombre del material",value:"title",width:"auto"},{text:"Acciones",value:"actions",align:"center",sortable:!1}],patients_material:[],editedItem:{title:"",message:"",content:"",material_type:"",file:""},defaulItem:{title:"",message:"",content:"",material_type:"",file:""},patient:{},editedIndex:-1},watch:{isSelected:function(){this.getPatientMaterial(this.isSelected)}},computed:{searchPatient:function(){return this.patients_results=this.patients.filter(e=>e.full_name.toLowerCase().includes(this.search.toLowerCase()))}},created:function(){this.initialize()},mounted:function(){},methods:{initialize:function(){var e=api_url+"patients/get";this.$http.get(e).then(e=>{var i;0<e.body.length&&(i=[],e.body.forEach(e=>{var t={};t.patient_id=e.patient_id,t.first_name=e.first_name,t.last_name=e.last_name,t.full_name=e.first_name+" "+e.last_name,t.email=e.email,t.birthregistered_at=e.birthregistered_at,i.push(t)}),this.patients=i)},e=>{})},getPatientMaterial:function(e){var t=this;e&&(t.patients_material=[],e=api_url+"patients-material/get/"+t.patient.patient_id,t.$http.get(e).then(e=>{0<e.body.length&&(t.patients_material=e.body)},e=>{}))},resetSearch:function(){this.searched=!1,this.isSelected=!1,this.patient_id="",this.patient={}},showItem:function(e){this.editedIndex=this.patients_material.indexOf(e),this.editedItem=Object.assign({},e),this.viewDialog=!0},deleteItem:function(e){this.editedIndex=this.patients_material.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm:function(){var t=this,e=api_url+"patients-material/delete";t.$http.post(e,{patient_material_id:t.editedItem.patient_material_id}).then(e=>{"success"==e.body.status&&t.patients_material.splice(t.editedIndex,1),activateAlert(e.body.message,e.body.status),t.closeDelete()},e=>{t.closeDelete()})},close:function(){this.dialog=!1,this.materialFormDialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeViewDialog:function(){this.dialog=!1,this.viewDialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},closeDelete:function(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save:function(){var t=this;t.material_loading=!0;t.editedIndex;var e=new FormData;e.append("patient_id",t.patient.patient_id),e.append("email",t.patient.email),e.append("first_name",t.patient.first_name),e.append("last_name",t.patient.last_name),e.append("full_name",t.patient.full_name),e.append("file",t.editedItem.file),e.append("title",t.editedItem.title),e.append("material",t.editedItem.material_type),e.append("content",t.editedItem.content),e.append("message",t.editedItem.message);var i=api_url+"patients-material/create";t.$http.post(i,e).then(e=>{"success"==e.body.status&&(t.editedItem.registered_at=moment().format("YYYY-MM-DD")),t.editedItem.patient_material_id=e.body.data.patient_material_id,t.editedItem.file=e.body.data.file,t.patients_material.push(t.editedItem),t.material_loading=!1,t.close(),activateAlert(e.body.message,e.body.status)},e=>{})}}});