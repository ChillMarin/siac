let vm=new Vue({vuetify:vuetify,el:"#siac-suite-container",data:{barAlert:!1,barTimeout:1e3,barMessage:"",barType:"",loading:!1,dialog:!1,dialogDelete:!1,headers:[{text:"Nombre",align:"start",value:"upcm_name"},{text:"Provincia / País",value:"location"},{text:"Clave de certificación",value:"upcm_key"},{text:"Fecha de registro",value:"upcm_registered"},{text:"Acciones",value:"actions",align:"center",sortable:!1}],upcms:[],countries:[],states:[],country_states:[],editedIndex:-1,editedItem:{},defaultItem:{upcm_registered:current_date}},computed:{formTitle:function(){return-1===this.editedIndex?"Registrar UPCM":"Editar UPCM"}},watch:{dialog:function(t){t||this.close()},dialogDelete:function(t){t||this.closeDelete()}},created:function(){this.initialize()},mounted:function(){this.loadCountries()},methods:{initialize:function(){var t=api_url+"upcms/get";this.$http.get(t).then(t=>{this.upcms=t.body},t=>{})},editItem:function(t){this.editedIndex=this.upcms.indexOf(t),this.editedItem=Object.assign({},t),this.dialog=!0},deleteItem:function(t){this.editedIndex=this.upcms.indexOf(t),this.editedItem=Object.assign({},t),this.dialogDelete=!0},deleteItemConfirm:function(){var t=this.editedItem.upcm_id,e=api_url+"upcms/delete";this.$http.post(e,{upcm_id:t}).then(t=>{"success"==t.body.status&&this.upcms.splice(this.editedIndex,1),this.closeDelete(),activateAlert(t.body.message,t.body.status)},t=>{this.closeDelete()})},closeDelete:function(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},close:function(){this.dialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save:function(){var t,e=this,i=e.editedIndex,s=e.editedItem;-1<this.editedIndex?(t=api_url+"upcms/update",this.$http.post(t,s).then(t=>{"success"==t.body.status&&Object.assign(e.upcms[i],s),activateAlert(t.body.message,t.body.status),this.close()},t=>{this.close()})):(t=api_url+"upcms/create",this.$http.post(t,s).then(t=>{"success"==t.body.status&&(s.upcm_registered=current_date,s.upcm_id=t.body.data,this.upcms.push(s)),activateAlert(t.body.message,t.body.status),this.close()},t=>{this.close()}))},formatDate:function(t){return new Date(t).toLocaleString("es-ES",date_options)},loadCountries:function(){this.$http.get("/public/js/countries.min.json").then(t=>{this.countries=t.body.countries},t=>{}),this.$http.get("/public/js/states.min.json").then(t=>{this.states=t.body.states},t=>{})},filterStates:function(){var t=this.states,e=this.editedItem.country_selected,t=t.filter(function(t){return t.id_country==e});return this.country_states=t},getCountryName:function(){var t=this,e=t.countries,i=t.editedItem.country_selected,e=e.filter(function(t){return t.id==i});return t.editedItem.upcm_country=e[0].name},getStateName:function(){var t=this,e=t.states,i=t.editedItem.state_selected,e=e.filter(function(t){return t.id==i});return t.editedItem.upcm_state=e[0].name},getLocation:function(){this.getCountryName(),this.getStateName()}}});