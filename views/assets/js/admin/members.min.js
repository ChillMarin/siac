Vue.use(VueTelInputVuetify,{vuetify:vuetify});let vm=new Vue({vuetify:vuetify,el:"#siac-suite-container",data:{barAlert:!1,barTimeout:1e3,barMessage:"",barType:"",loading:!1,dialog:!1,dialogDelete:!1,birthdateDialog:!1,modal:!1,headers:[{text:"Nombre completo",align:"start",value:"full_name"},{text:"Tipo de usuario",value:"user_type"},{text:"Correo electrónico",value:"email"},{text:"Acciones",value:"actions",align:"center",sortable:!1}],members:[],upcms:[],rols:["Cardiólogo","Enfermera","Enfermero","Secretaria"],user_types:["administrador","coordinador","miembro"],genders:[{name:"Masculino",gender:"M"},{name:"Femenino",gender:"F"}],access:{loading:!1,defaultItem:{patient_management_access:{access:1,sections:[{name:"Pacientes",page:"patients",permissions:{create:0,read:0,update:0,delete:0}},{name:"Citas",page:"appointments",permissions:{create:0,read:0,update:0,delete:0}}]},calculations_and_algorithms_access:{access:1},patient_material_access:{access:1,sections:[{name:"Materiales para pacientes",page:"patients",permissions:{create:0,read:0,delete:0}},{name:"Plantillas",page:"templates",permissions:{create:0,read:0,delete:0}}]},notifications_access:{access:1,publish:1}}},password:"",password_confirm:"",editedIndex:-1,editedItem:{full_name:"",rol:"",email:"",telephone:"",meta:{}},defaultItem:{full_name:"",rol:"",email:"",telephone:"",date:current_date,whatsapp:"0",telegram:"0",sms:"0",meta:{}}},computed:{formTitle(){return-1===this.editedIndex?"Registrar Miembro":"Editar Miembro"}},watch:{dialog(e){e||this.close()},dialogDelete(e){e||this.closeDelete()}},created(){this.initialize()},mounted(){},methods:{initialize(){var e=api_url+"upcms/upcm-list";this.$http.get(e).then(e=>{this.upcms=e.body},e=>{});e=api_url+"members/get";this.$http.get(e).then(e=>{e.body.forEach(e=>{Array.isArray(e.meta)&&(e.meta={})}),this.members=e.body},e=>{})},editItem(e){this.editedIndex=this.members.indexOf(e),this.editedItem=Object.assign({},e),this.editedItem.meta=0===Object.keys(e.meta).length?Object.assign({},this.access.defaultItem):Object.assign({},e.meta),this.dialog=!0},deleteItem(e){this.editedIndex=this.members.indexOf(e),this.editedItem=Object.assign({},e),this.dialogDelete=!0},deleteItemConfirm(){var e=this.editedItem.user_id,t=api_url+"members/delete";this.$http.post(t,{user_id:e}).then(e=>{"success"==e.body.status&&this.members.splice(this.editedIndex,1),this.closeDelete(),activateAlert(e.body.message,e.body.status)},e=>{this.closeDelete()})},closeDelete(){this.dialogDelete=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},close(){this.dialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},save(){var e=this,t=e.editedIndex,s=e.editedItem;if(this.editedIndex>-1){var i=api_url+"members/update";this.$http.post(i,s).then(i=>{"success"==i.body.status&&Object.assign(e.members[t],s),activateAlert(i.body.message,i.body.status)},e=>{})}else{i=api_url+"members/create";this.$http.post(i,s).then(e=>{"success"==e.body.status&&(s.date=current_date),s.user_id=e.body.data.user_id,this.members.push(s),activateAlert(e.body.message,e.body.status)},e=>{})}this.close()},getTelephoneInput(e,t){this.editedItem.telephone=t.number.international},filterAccessByRol(){var e=this;if("miembro"==e.editedItem.user_type){var t=[{rol_obj:"cardiologist",rol:"Cardiólogo"},{rol_obj:"nurse",rol:"Enfermera"},{rol_obj:"nurse",rol:"Enfermero"},{rol_obj:"secretary",rol:"Secretaria"}],s=t.find(t=>t.rol==e.editedItem.rol);s.hasOwnProperty("rol_obj")&&(console.log(s),e.editedItem.meta=Object.assign({},user_roles[s.rol_obj]))}}}});